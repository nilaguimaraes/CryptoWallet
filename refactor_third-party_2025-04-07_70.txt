Refactor third-party authentication for service (major)
