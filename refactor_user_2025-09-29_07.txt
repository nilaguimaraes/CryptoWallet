Refactor user authentication for client (critical)
