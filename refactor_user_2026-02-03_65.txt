Refactor user authentication for session (simplified)
